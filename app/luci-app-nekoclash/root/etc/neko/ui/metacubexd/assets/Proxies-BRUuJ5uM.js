import{u as q,f as e,au as be,i as t,ai as A,av as fe,aw as pe,C as $,ax as $e,ay as _e,az as ye,F,aA as we,aB as Ce,aC as Pe,aD as Se,aE as R,_ as b,aF as Te,aG as Le,aH as Ne,aI as Ee,aJ as Z,aK as ve,aL as G,aM as W,O as Ie,t as h,aN as De,aO as se,S as H,aP as D,aQ as he,aR as te,a0 as B,$ as J,ag as ke,G as ee,D as Me,V as Oe,b as Ae,x as Be,P as Fe,Q as Ue,y as le,o as je,B as Q,aS as ie,a5 as Re,aT as He,aU as ae,aV as ce,aW as oe,aX as de,k as Ye}from"./index-BZArfFYe.js";import{f as ze}from"./global-NfGaYd_E.js";var Qe=h('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full">'),Ve=h('<option class="flex items-center gap-2">'),Xe=h("<option>");const Ke=l=>{const[r]=q();return e(Ie,{ref:n=>{var i;return(i=l.ref)==null?void 0:i.call(l,n)},get icon(){return e(be,{size:24})},get title(){return r("proxiesSettings")},get children(){var n=Qe(),i=n.firstChild,c=i.firstChild,u=c.firstChild,m=i.nextSibling,N=m.firstChild,d=m.nextSibling,k=d.firstChild,f=d.nextSibling,C=f.firstChild,P=f.nextSibling,S=P.firstChild,g=P.nextSibling,M=g.firstChild,_=M.firstChild,E=g.nextSibling,I=E.firstChild,V=I.firstChild,X=E.nextSibling,U=X.firstChild;return t(i,e(A,{withDivider:!0,get children(){return r("autoCloseConns")}}),c),u.addEventListener("change",o=>fe(o.target.checked)),t(m,e(A,{withDivider:!0,get children(){return r("urlForLatencyTest")}}),N),N.addEventListener("change",o=>pe(o.target.value)),t(d,e(A,{withDivider:!0,get children(){return[$(()=>r("latencyTestTimeoutDuration"))," (",$(()=>r("ms")),")"]}}),k),k.addEventListener("change",o=>$e(Number(o.target.value))),t(f,e(A,{withDivider:!0,get children(){return r("urlForIPv6SupportTest")}}),C),C.addEventListener("change",o=>{var x;return _e((x=o.target.value)==null?void 0:x.trim())}),t(P,e(A,{withDivider:!0,get children(){return r("proxiesSorting")}}),S),S.addEventListener("change",o=>ye(o.target.value)),t(S,e(F,{get each(){return Object.values(we)},children:o=>(()=>{var x=Ve();return x.value=o,t(x,()=>r(o)),x})()})),t(g,e(A,{withDivider:!0,get children(){return r("hideUnAvailableProxies")}}),M),_.addEventListener("change",o=>Ce(o.target.checked)),t(E,e(A,{withDivider:!0,get children(){return r("renderInTwoColumns")}}),I),V.addEventListener("change",o=>Pe(o.target.checked)),t(X,e(A,{withDivider:!0,get children(){return r("proxiesPreviewType")}}),U),U.addEventListener("change",o=>Se(o.target.value)),t(U,e(F,{get each(){return Object.values(R)},children:o=>(()=>{var x=Xe();return x.value=o,t(x,()=>r(o)),x})()})),b(()=>u.checked=Te()),b(()=>N.value=Le()),b(()=>k.value=Ne()),b(()=>C.value=Ee()),b(()=>S.value=Z()),b(()=>_.checked=ve()),b(()=>V.checked=G()),b(()=>U.value=W()),n}})},ue=l=>{const r=()=>W()===R.OFF,n=$(()=>l.proxyNameList.length<=10),i=$(()=>{const u=W();return u===R.BAR||u===R.Auto&&!n()}),c=$(()=>{const u=W();return u===R.DOTS||u===R.Auto&&n()});return e(H,{get when(){return!r()},get children(){return e(De,{get children(){return[e(se,{get when(){return i()},get children(){return e(Je,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}}),e(se,{get when(){return c()},get children(){return e(et,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}})]}})}})};var We=h('<div class="flex items-center gap-2 py-2"><div class="my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const Je=l=>{const{getLatencyByName:r}=te(),n=$(()=>l.proxyNameList.map(d=>r(d))),i=$(()=>n().length),c=$(()=>n().filter(d=>d>D().NOT_CONNECTED&&d<=D().MEDIUM).length),u=$(()=>n().filter(d=>d>D().MEDIUM&&d<=D().HIGH).length),m=$(()=>n().filter(d=>d>D().HIGH).length),N=$(()=>n().filter(d=>d===D().NOT_CONNECTED).length);return(()=>{var d=We(),k=d.firstChild,f=k.firstChild,C=f.nextSibling,P=C.nextSibling,S=P.nextSibling;return t(d,e(he,{get name(){return l.now}}),null),b(g=>{var M=`${c()*100/i()}%`,_=`${u()*100/i()}%`,E=`${m()*100/i()}%`,I=`${N()*100/i()}%`;return M!==g.e&&((g.e=M)!=null?f.style.setProperty("width",M):f.style.removeProperty("width")),_!==g.t&&((g.t=_)!=null?C.style.setProperty("width",_):C.style.removeProperty("width")),E!==g.a&&((g.a=E)!=null?P.style.setProperty("width",E):P.style.removeProperty("width")),I!==g.o&&((g.o=I)!=null?S.style.setProperty("width",I):S.style.removeProperty("width")),g},{e:void 0,t:void 0,a:void 0,o:void 0}),d})()};var qe=h("<div>"),Ze=h('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const Ge=l=>{let r=l.selected?"bg-white border-4 border-success":"bg-success";return typeof l.latency!="number"||l.latency===D().NOT_CONNECTED?r=l.selected?"bg-white border-4 border-neutral":"bg-neutral":l.latency>D().HIGH?r=l.selected?"bg-white border-4 border-error":"bg-error":l.latency>D().MEDIUM&&(r=l.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var n=qe();return b(i=>{var c=B("h-4 w-4 rounded-full",r),u=l.name;return c!==i.e&&J(n,i.e=c),u!==i.t&&ke(n,"title",i.t=u),i},{e:void 0,t:void 0}),n})()},et=l=>{const{getLatencyByName:r}=te();return(()=>{var n=Ze(),i=n.firstChild;return t(i,e(F,{get each(){return l.proxyNameList.map(c=>[c,r(c)])},children:([c,u])=>{const m=l.now===c;return e(Ge,{name:c,latency:u,selected:m})}})),t(n,e(he,{get name(){return l.now}}),null),n})()};var tt=h("<progress class=progress max=100>"),nt=h('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),rt=h('<div class="text-sm text-slate-500">: ');const st=l=>{const{Download:r=0,Upload:n=0,Total:i=0,Expire:c=0}=l,u=ee(i,{units:"iec"}),m=ee(r+n,{units:"iec"}),N=Me.toFinite(((r+n)/i*100).toFixed(2));return{total:u,used:m,percentage:N,expirePrefix:()=>{const[f]=q();return f("expire")},expireStr:()=>{const[f]=q();return c===0?f("noExpire"):Oe(c*1e3).format("YYYY-MM-DD")}}},lt=l=>{if(!l.subscriptionInfo)return;const r=st(l.subscriptionInfo);return[(()=>{var n=tt();return b(()=>n.value=r.percentage),n})(),(()=>{var n=nt(),i=n.firstChild,c=i.nextSibling,u=c.nextSibling,m=u.nextSibling;return m.nextSibling,t(n,()=>`${r.used}`,i),t(n,()=>`${r.total}`,c),t(n,()=>r.percentage,m),n})(),(()=>{var n=rt(),i=n.firstChild;return t(n,()=>r.expirePrefix(),i),t(n,()=>r.expireStr(),null),n})()]};var ge=h("<div>"),it=h('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),at=h('<button><span></span><div class="badge badge-sm">'),ct=h('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm">'),ot=h('<div class="text-sm text-slate-500"> <!> <!>/s'),dt=h('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),ut=h('<div class="text-sm text-slate-500"> :: <!> ');const ht=()=>{const l=Ae();if(!Be())return l("/setup",{replace:!0}),null;let r;const[n]=q(),{fetchProxies:i,proxies:c,selectProxyInGroup:u,proxyProviders:m,updateProviderByProviderName:N,updateAllProvider:d,proxyGroupLatencyTest:k,proxyProviderLatencyTest:f,proxyGroupLatencyTestingMap:C,proxyProviderLatencyTestingMap:P,isAllProviderUpdating:S,updatingMap:g}=te(),{speedGroupByName:M}=Fe(),[_,E]=Ue(le({}),{name:"collapsedMap",storage:localStorage}),I=(p,y)=>{E(K=>({...K,[p]:y}))};je(i);const V=async(p,y)=>{p.stopPropagation(),k(y)},X=(p,y)=>{p.stopPropagation(),f(y)},U=(p,y)=>{p.stopPropagation(),N(y)},o=async p=>{p.stopPropagation(),d()},[x,me]=le("proxies"),xe=()=>[{type:"proxies",name:n("proxies"),count:c().length},{type:"proxyProviders",name:n("proxyProviders"),count:m().length}];return(()=>{var p=it(),y=p.firstChild,K=y.firstChild,ne=K.nextSibling,re=y.nextSibling;return t(K,e(F,{get each(){return xe()},children:v=>(()=>{var s=at(),O=s.firstChild,Y=O.nextSibling;return s.$$click=()=>me(v.type),t(O,()=>v.name),t(Y,()=>v.count),b(()=>J(s,B(x()===v.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),s})()})),t(y,e(H,{get when(){return x()==="proxyProviders"},get children(){return e(Q,{class:"btn btn-circle btn-sm",get disabled(){return S()},onClick:v=>o(v),get icon(){return e(ie,{get class(){return B(S()&&"animate-spin text-success")}})}})}}),ne),t(ne,e(Q,{class:"btn-circle btn-primary btn-sm",onClick:()=>r==null?void 0:r.showModal(),get icon(){return e(Re,{})}})),t(re,e(H,{get when(){return x()==="proxies"},get children(){var v=ge();return t(v,e(F,{get each(){return c()},children:s=>{const O=$(()=>He(ae(s.all??[],Z()),ve())),Y=[(()=>{var a=ct(),T=a.firstChild,w=T.firstChild,z=w.nextSibling;return t(w,()=>s.name),t(z,()=>{var L;return(L=s.all)==null?void 0:L.length}),t(a,e(Q,{class:"btn-circle btn-sm",get disabled(){return C()[s.name]},onClick:L=>V(L,s.name),get icon(){return e(ce,{get class(){return B(C()[s.name]&&"animate-pulse text-success")}})}}),null),a})(),(()=>{var a=ot(),T=a.firstChild,w=T.nextSibling,z=w.nextSibling,L=z.nextSibling;return L.nextSibling,t(a,()=>s.type,T),t(a,()=>{var j;return((j=s.now)==null?void 0:j.length)>0&&` :: ${s.now}`},w),t(a,()=>ee(M()[s.name]??0).toString(),L),a})(),e(H,{get when(){return!_()[s.name]},get children(){return e(ue,{get proxyNameList(){return O()},get now(){return s.now}})}})];return e(oe,{get isOpen(){return _()[s.name]},title:Y,onCollapse:a=>I(s.name,a),get children(){return e(F,{get each(){return O()},children:a=>e(de,{proxyName:a,get isSelected(){return s.now===a},onClick:()=>void u(s,a)})})}})}})),b(()=>J(v,B("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),v}}),null),t(re,e(H,{get when(){return x()==="proxyProviders"},get children(){var v=ge();return t(v,e(F,{get each(){return m()},children:s=>{const O=$(()=>ae(s.proxies.map(a=>a.name)??[],Z())),Y=[(()=>{var a=dt(),T=a.firstChild,w=T.firstChild,z=w.nextSibling,L=T.nextSibling;return t(w,()=>s.name),t(z,()=>s.proxies.length),t(L,e(Q,{class:"btn btn-circle btn-sm",get disabled(){return g()[s.name]},onClick:j=>U(j,s.name),get icon(){return e(ie,{get class(){return B(g()[s.name]&&"animate-spin text-success")}})}}),null),t(L,e(Q,{class:"btn btn-circle btn-sm",get disabled(){return P()[s.name]},onClick:j=>X(j,s.name),get icon(){return e(ce,{get class(){return B(P()[s.name]&&"animate-pulse text-success")}})}}),null),a})(),e(lt,{get subscriptionInfo(){return s.subscriptionInfo}}),(()=>{var a=ut(),T=a.firstChild,w=T.nextSibling;return w.nextSibling,t(a,()=>s.vehicleType,T),t(a,()=>n("updated"),w),t(a,()=>ze(s.updatedAt),null),a})(),e(H,{get when(){return!_()[s.name]},get children(){return e(ue,{get proxyNameList(){return O()}})}})];return e(oe,{get isOpen(){return _()[s.name]},title:Y,onCollapse:a=>I(s.name,a),get children(){return e(F,{get each(){return O()},children:a=>e(de,{proxyName:a})})}})}})),b(()=>J(v,B("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),v}}),null),t(p,e(Ke,{ref:v=>r=v}),null),p})()};Ye(["click"]);export{ht as default};
